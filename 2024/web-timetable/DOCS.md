# はじめの一歩は時間割

<details>
  <summary>目次</summary>

- [はじめの一歩は時間割](#はじめの一歩は時間割)
  - [1. 初めてのWebアプリを作ろう](#1-初めてのwebアプリを作ろう)
    - [1.1. HTML/CSSを始めよう](#11-htmlcssを始めよう)
      - [1.1.1. 基本的なHTML要素を知ろう](#111-基本的なhtml要素を知ろう)
      - [1.1.2. CSSボックスモデルを知ろう](#112-cssボックスモデルを知ろう)
      - [1.1.3. フレックスボックス、グリッドレイアウトを使ってみよう](#113-フレックスボックスグリッドレイアウトを使ってみよう)
    - [1.2. JavaScriptを組み合わせよう](#12-javascriptを組み合わせよう)
      - [1.2.1. ボタンで表示を変えてみよう](#121-ボタンで表示を変えてみよう)
  - [2. 時間割アプリのデザインを考えよう](#2-時間割アプリのデザインを考えよう)
    - [2.1. 必要な機能を洗い出そう](#21-必要な機能を洗い出そう)
    - [2.2. デザインを考えよう](#22-デザインを考えよう)
  - [3. Web開発を楽にする手段を知ろう](#3-web開発を楽にする手段を知ろう)
    - [3.1. VSCodeの設定を調整しよう](#31-vscodeの設定を調整しよう)
    - [3.2. JSDocを書いてみよう](#32-jsdocを書いてみよう)
    - [3.3. CSSカスタムプロパティを使ってみよう](#33-cssカスタムプロパティを使ってみよう)
    - [3.4. カスタム要素を作ってみよう](#34-カスタム要素を作ってみよう)
    - [3.5. 見やすいディレクトリ構成を考えよう](#35-見やすいディレクトリ構成を考えよう)
  - [4. ページを用意しよう](#4-ページを用意しよう)
    - [4.1. ルーティングを自作しよう](#41-ルーティングを自作しよう)
    - [4.2. ひとつめのページを用意しよう](#42-ひとつめのページを用意しよう)
    - [4.3. ふたつめのページを用意しよう](#43-ふたつめのページを用意しよう)
  - [5. データを保存しよう](#5-データを保存しよう)
    - [5.1. IndexedDBを使ってみよう](#51-indexeddbを使ってみよう)
    - [5.2. 使いやすいよう、ラッパーを用意しよう](#52-使いやすいようラッパーを用意しよう)
  - [6. 科目を登録できるようにしよう](#6-科目を登録できるようにしよう)
    - [6.1. 科目の情報の型を考えよう](#61-科目の情報の型を考えよう)
    - [6.2. 必要な情報を入力できるようにしよう](#62-必要な情報を入力できるようにしよう)
    - [6.3. 科目の情報を保存しよう](#63-科目の情報を保存しよう)
    - [6.4. 開発者モードから登録した内容を確認しよう](#64-開発者モードから登録した内容を確認しよう)
  - [7. 科目を一覧・管理できるようにしよう](#7-科目を一覧管理できるようにしよう)
    - [7.1. 登録した科目を一覧で表示しよう](#71-登録した科目を一覧で表示しよう)
    - [7.2. 繰り返しを使って表示を作ろう](#72-繰り返しを使って表示を作ろう)
  - [8. 時間割表を表示できるようにしよう](#8-時間割表を表示できるようにしよう)
    - [8.1. 表の見た目を作ろう](#81-表の見た目を作ろう)
    - [8.2. 表に科目を設定できるようにしよう](#82-表に科目を設定できるようにしよう)

</details>

## 1. 初めてのWebアプリを作ろう

まずは初めてのWebアプリとして、「カウンター」を作ってみることを目標にしましょう。

![作るカウンターアプリのイメージ](imgs/counter-app.gif)

[GitHub](https://github.com/) に「vanilla-counter」という名前でリポジトリを用意してください。  
`git clone <URL>` として手元にcloneして、VSCodeでcloneしたリポジトリを開いてください。

VSCodeのエクスプローラーから「index.html」「style.css」「main.mjs」の名前でファイルを作成してください。

![各ファイルを作成した状態](imgs/1-create-files.png)

### 1.1. HTML/CSSを始めよう

初歩的なWebページを作成するために、最低限必要な知識を学習しましょう。  
作成した「index.html」を開いてください。

#### 1.1.1. 基本的なHTML要素を知ろう

<!-- 
* DOCTYPE宣言
* html, head, body
* meta-charset, meta-viewport, link-stylesheet, script
* div
* span
-->

まずはDOCTYPE宣言を書きましょう。

```html
<!DOCTYPE html>
```

この宣言には、ブラウザがHTMLを解釈するときのモードを指定する役割があります。  
書かないと表示が意図しないものになるので、必ず書くようにしてください。

次にHTMLを追加していきます。

```html
<html>
  <head>

  </head>
  <body>

  </body>
</html>
```

それぞれ「htmlタグ」「headタグ」「bodyタグ」のように呼び、以下のような意味があります。

| タグ | 意味 |
| :---: | --- |
| `<html>` | HTML文書が書かれていることを示す。 |
| `<head>` | 文書に関するメタデータが書かれていることを示す。この要素の内容は文書中には表示されない。 |
| `<body>` | 文書の内容が書かれていることを示す。 |

headタグ内にメタデータを追記しましょう。

```html
<meta charset="UTF=8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>カウンター</title>
<link rel="stylesheet" href="style.css" />
<script type="module" src="main.mjs"></script>
```

HTMLには上記の`<meta>`や`<link>`のように閉じタグを持たない要素があります。  
このような要素を「self-closing tag」と呼ぶこともあります。

ここで出てきた各要素の意味も説明しましょう。

| タグ | 意味 |
| :---: | --- |
| `<meta charset="<文字エンコード>" />` | 文書の文字コードを指定する。 |
| `<meta name="viewport" content="width=device-width, initial-scale=1.0" />` | ブラウザで表示する領域の大きさを指定する。 |
| `<title>` | 文書のタイトルを示す。 |
| `<link rel="stylesheet" href="<CSSファイルへのパス>">` | 文書に適用するスタイルシートの置き場を示す。 |
| `<script type="module">` | JavaScriptが書かれていることを示す。src属性を指定したときは実行するJavaScriptファイルの置き場を示す。 |

その他にもメタデータとして`<head>`内に記述する要素はありますが、最低限以上の内容を記述しておけばよいでしょう。

では、最後に`<body>`内にページの内容を記述しましょう。  

```html
    <div class="app">
      <span>カウンター</span>
      <div class="counter-container">
        <span class="count">0</span>
      </div>
    </div>
```

ここまでかけたら変更を保存して、`Ctrl+Shift+P`でコマンドパレットを開いて「Live Server」と検索します。  
「Live Server: Open with Live Server」を選択して実行しましょう。起動メッセージが表示されたあと、ブラウザで「http://127.0.0.1:5500/index.html」が開くはずです。

![コマンドパレットの表示](imgs/1-1-1-live-server.png)

![ブラウザの表示](imgs/1-1-1-browser.png)

最後に登場した2つのHTML要素についても説明しましょう。

| タグ | 意味 |
| :---: | --- |
| `<div>` | フローコンテンツの汎用ブロックコンテナー。要素を囲んでCSSで修飾したいときに利用する。 |
| `<span>` | 記述コンテンツ汎用インラインコンテナー。文字列を囲んでCSSで修飾したいときに利用する。 |

Webアプリはこの要素と後述するCSSセレクターがあれば作成できるでしょう。  
しかし、本来であればHTML要素は記述内容の目的に合わせて適切に利用される必要があるため、この2つのみではなくより多くのタグを利用することになります。  
今回の開発では簡単のためこの2つの要素を主に利用します。

#### 1.1.2. [CSSボックスモデルを知ろう](https://github.com/jigintern/intern-dev-tutorial/blob/main/html-css/DOCS.md#3-2-%E3%83%9C%E3%83%83%E3%82%AF%E3%82%B9%E3%83%A2%E3%83%87%E3%83%AB%E3%81%A8box-sizing)

この単元は別資料を参照します。

<https://github.com/jigintern/intern-dev-tutorial/blob/main/html-css/DOCS.md#3-2-%E3%83%9C%E3%83%83%E3%82%AF%E3%82%B9%E3%83%A2%E3%83%87%E3%83%AB%E3%81%A8box-sizing>

以下の内容を `style.css` に記述しましょう。

```css
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html,body {
  width: 100dvw;
  height: 100dvh;
  overflow: hidden;
  touch-action: manipulation;
}
```

ここで`*`のようにその後に`{}`で囲まれたブロックを持つ部分を「セレクタ」と呼びます。  
セレクタはその後のブロックに記述されたCSSをどこに適用するのかを示すもので、今回利用している`*`は「全称セレクタ」というものです。  
適用しているCSSはそれぞれ、ボックスモデルを指定する`box-sizing`と、それぞれの要素に最初から設定されている事がある`margin`と`padding`を0にして取り扱いやすくするスタイルです。

#### 1.1.3. フレックスボックス、グリッドレイアウトを使ってみよう

<!--
* flex
* grid
-->

フレックスボックス、グリッドレイアウトはそれぞれ、CSSの`display`プロパティに`flex`、`grid`を指定することで利用できるレイアウト方法です。  
フレックスボックスは1次元的、グリッドレイアウトは2次元的なレイアウトが可能になります。

[1.1.1.](#111-基本的なhtml要素を知ろう)で作成したページにレイアウトをつけてみましょう。  
イメージは以下のとおりです。

* 「カウンター」というタイトルは画面上部に固定
* タイトルとカウンター本体は直線上に縦に並ぶ
* タイトルとカウンターは左右中央揃えになる
* カウンター本体はカウントと後でボタンを追加する
* カウンターはタイトル以外の画面を

これからCSSを考えると以下のようになります。

```css
.app {
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;

  & > span {
    height: 32px;
    font-size: 24px;
    font-weight: bold;
  }

  & > div.counter-container {
    height: 100%;
    width: 100%;
    display: grid;
    grid-template: ". count ." 32px
                   "minus . plus" 32px
                  / 1fr 100px 1fr;
    gap: 8px;
    place-content: center;

    & > span.count {
      width: 100%;
      grid-area: count;
      font-weight: bold;
      text-align: center;
    }
  }
}
```

保存してブラウザで確認すると以下のように表示が変わっているはずです。

![CSSが適用された画面の様子](imgs/1-1-3-attach-css.png)

では次の章でボタンを追加して、カウントを変化させられるようにしましょう。

### 1.2. JavaScriptを組み合わせよう

JavaScriptはWebブラウザを始め、サーバー環境などでも利用されているインタープリター型のプログラミング言語です。

#### 1.2.1. ボタンで表示を変えてみよう

<!--
* button要素
* querySelector
* textContent
* addEventListener
* onClick
-->

まずはボタン要素を`div.counter-container`の中に作成して、CSSで`grid-area`に`plus`、`minus`のそれぞれを指定してレイアウトを整えましょう。

```html
        <button class="plus">+</button>
        <button class="minus">-</button>
```

```css
    & > button.plus {
      grid-area: plus;
    }
    & > button.minus {
      grid-area: minus;
    }
```

これで以下の画像のような表示になるはずです。

![ボタンを追加した見た目](imgs/1-2-add-buttons.png)

次に、それぞれのボタンから要素を操作できるようにしましょう。  
以下の内容を`main.mjs`に記述してください。

```javascript
// ページに表示するカウントを管理するための変数
let count = 0;

function onClickPlus() {
  count += 1;
  // カウントを表示する要素を取得
  const countElem = document.querySelector("span.count");
  // 要素の内容を現在のカウントで書き換え
  countElem.textContent = count;
}

function onClickMinus() {
  count -= 1;
  // カウントを表示する要素を取得
  const countElem = document.querySelector("span.count");
  // 要素の内容を現在のカウントで書き換え
  countElem.textContent = count;
}

// それぞれのボタン要素を取得して、それぞれにあった関数がボタンクリックで実行されるように設定
// 要素はクリックされた時に"click"という「イベント」を発生させるので、そのイベントを監視する
document.querySelector("button.plus").addEventListener("click", onClickPlus);
document.querySelector("button.minus").addEventListener("click", onClickMinus);
```

これでカウンターアプリ完成です！  
以下の画像のように、自由に値を増減できていればOKです。

![カウンターアプリのデモ](imgs/1-2-coutner-demo.gif)

## 2. 時間割アプリのデザインを考えよう

実際に時間割アプリを作り始める前に、まずは作るアプリのイメージを作りましょう。

### 2.1. 必要な機能を洗い出そう

<!--
* 時間割と聞いて思い浮かべるもの→表
* 科目の管理
* 表の管理
-->

時間割アプリと一口に言っても、必要な機能は様々あります。
必要な機能を洗い出してみましょう。

* 時間割が見れる
* 時間割に科目を登録できる
* 科目を登録できる

の大きく3つが最低限必要なことがわかります。  
このうち、1つ目の「時間割が見れる」は「ユーザーの操作を取り消す」ような機能が必要ありませんが、それ以外は「誤った情報を登録してしまった」ような場合に登録を修正したり削除したりできる必要がありそうです。  
なので、結局は以下の4機能も含めて最低限7つの機能が必要になることがわかります。

* 時間割に登録した授業を変更できる
* 時間割に登録した授業を登録解除できる
* 科目の情報を編集できる
* 科目を削除できる

### 2.2. デザインを考えよう

<!--
* 時間割表の表示・管理画面
* 科目の登録画面
* 科目の管理画面
-->

[2.1.](#21-必要な機能を洗い出そう)で最低限必要な機能を洗い出すことができました。  
次にこの機能を実装する画面を考えていきます。

今回は3画面を作成することとして、それぞれ以下のように機能を振り分けます。

* 時間割表
  * 時間割の表示
  * 時間割に授業を登録・変更・削除する
  * *科目一覧画面への遷移*
* 科目一覧
  * 科目の削除
  * *科目の一覧*
  * *科目の編集画面への遷移*
  * *科目の登録画面への遷移*
  * *時間割表への遷移*
* 科目編集（新規作成も編集も同じ画面で処理できるようにする）
  * 科目の情報の編集・登録
  * *科目一覧への遷移*

これらの機能をもつそれぞれの画面をスケッチしてみましょう。

![時間割表](imgs/2-2-table.png)
![一覧](imgs/2-2-list.png)
![科目](imgs/2-2-class.png)

これをもとに開発していきます。

## 3. Web開発を楽にする手段を知ろう

ここから再びエディタを利用して開発に戻るわけですが、その前に開発に便利に使える機能や知識を学習しましょう。

### 3.1. VSCodeの設定を調整しよう

* Editor: Tab size
* Editor: Word wrap
* Editor: Render Whitespace
* Editor: Format on save
* Editor: Default Formatter
* Prettier: Print width

### 3.2. JSDocを書いてみよう

* @type
* @typedef

### 3.3. CSSカスタムプロパティを使ってみよう

* カラートークン
* 要素の大きさの固定

### 3.4. カスタム要素を作ってみよう

* customElements.define()
* ライフサイクルコールバック
  * connectedCallback()
  * attributeChangedCallback()
* テンプレートリテラル
  * es6-string-html 拡張機能

### 3.5. 見やすいディレクトリ構成を考えよう

* JavaScriptは別ファイルから値を読み込める
* 説明的な命名
* Web開発で頻出する名称
* 今回の基本構成

## 4. ページを用意しよう

アプリの各画面を作るため、それぞれの画面のためにページを作りましょう

### 4.1. ルーティングを自作しよう

* ルーティングとは
* URL hash (フラグメント識別子)
* hashChangeEvent
* ページの内容を書き換えよう

### 4.2. ひとつめのページを用意しよう

* カスタム要素でページを作る
* ルーティングに登録

### 4.3. ふたつめのページを用意しよう

* ひとつめと同様

## 5. データを保存しよう

入力したデータを保存して、利用できるようにしよう。

### 5.1. IndexedDBを使ってみよう

* IndexedDBとは
* 使い方 (ブラウザコンソールでやる)
  * データストア
  * データの挿入
  * データの取得
  * データの削除

### 5.2. 使いやすいよう、ラッパーを用意しよう

* Promise
  * 非同期処理とは
  * await

## 6. 科目を登録できるようにしよう

まず、表に出したり管理する科目をそもそも登録できるようにしよう。

### 6.1. 科目の情報の型を考えよう

* デザインから必要なデータを考える
* データを取り扱うために必要なデータを追加する

### 6.2. 必要な情報を入力できるようにしよう

* ひとつめのページの内容を修正する
* input
* レイアウトする

### 6.3. 科目の情報を保存しよう

* valueを取得する
* IndexedDBにデータを保存する

### 6.4. 開発者モードから登録した内容を確認しよう

* アプリケーションタブ → IndexedDB

## 7. 科目を一覧・管理できるようにしよう

次に、科目を管理するために一覧できるページを作成して、変更や削除をできるようにしよう。

### 7.1. 登録した科目を一覧で表示しよう

* ふたつめのページの内容を修正する
* リストの行のコンポーネントを作る

### 7.2. 繰り返しを使って表示を作ろう

* テンプレートリテラル中で繰り返し処理をする

## 8. 時間割表を表示できるようにしよう

最後に、これまで登録したデータを時間割表として表示できるようにしよう。

### 8.1. 表の見た目を作ろう

* 3つめのページを作成する
* 表のセルのコンポーネントを作る
* グリッドレイアウトで表のコンポーネントを作る

### 8.2. 表に科目を設定できるようにしよう

* 科目の詳細を表示するコンポーネントを作る
* 表のセルからクリックイベントを発火させる
* ページでイベントを購読する
* 変更内容を表に反映できるようにする
